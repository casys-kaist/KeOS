pub fn hypercall_exit() {
    super::run_vm::<0xcafe>(&[
        0xBF, 0xFE, 0xCA, 0x00, 0x00, // mov edi, 0xcafe
        0x31, 0xC0, // xor eax, eax
        0x0F, 0x01, 0xC1, // vmcall
    ]);
}

#[stdin(b"")]
#[assert_output(b"Hello guest os!\n")]
pub fn hypercall_print() {
    super::run_vm::<0>(&[
        0x48, 0x8D, 0x3D, 0x22, 0x00, 0x00, 0x00, // lea    rdi,[rip+0x22],
        0x48, 0xC7, 0xC6, 0x10, 0x00, 0x00, 0x00, // mov    rsi,0x10
        0x48, 0xC7, 0xC0, 0x01, 0x00, 0x00, 0x00, // mov    rax,0x1
        0x0F, 0x01, 0xC1, // vmcall
        0x48, 0xC7, 0xC7, 0x00, 0x00, 0x00, 0x00, // mov    rdi,0x0
        0x48, 0xC7, 0xC0, 0x00, 0x00, 0x00, 0x00, // mov    rax,0x0
        0x0F, 0x01, 0xC1, // vmcall
        // 0x22:
        0x48, 0x65, 0x6C, 0x6C, 0x6F, 0x20, 0x67, 0x75, 0x65, 0x73, 0x74, 0x20, 0x6F, 0x73, 0x21,
        0x0A,
    ]);
}
